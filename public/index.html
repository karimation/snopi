<!DOCTYPE html>
<html>

<head>
    <!-- Load the Paper.js library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="../lib/paper.js"></script>
    <!-- Define inlined PaperScript associate it with myCanvas -->
    <script type="text/paperscript" src="face.js" canvas="faceCanvas"></script>
</head>

<body>
    <canvas style="height: 92%;width: 92%;" id="faceCanvas" resize></canvas>
    <br>
    <button id='refresh'>Refresh</button>
    <button id='pause' style="background-color: red;">Pause</button>


    <h1 style="padding-top: 100px;text-align: left;">Training</h1>

    <div>

        <label for="fname">Question</label>
        <input type="text" id="question" name="firstname" placeholder="Question..">

        <label for="lname">Response</label>
        <input type="text" id="response" name="lastname" placeholder="Response..">


        <p id="checkFields" style="color: red;display: none">Please fill out all required fields ! </p>
        <input id='send' type="submit" value="Submit">

    </div>
    <script>


        $("#send").click(function () {
            const question = $('#question').val();
            const response = $('#response').val();
            alert("Are you sure ?");
            $('#checkFields').hide();
            var d = new Date();
            const intentName = "training" + d.getTime(); 
            const newData = {
                "contexts": [],
                "events": [],
                "fallbackIntent": false,
                "name": intentName,
                "priority": 500000,
                "responses": [
                    {
                        "action": "",
                        "affectedContexts": [],
                        "defaultResponsePlatforms": {
                            "google": true
                        },
                        "messages": [
                            {
                                "platform": "google",
                                "textToSpeech": response,
                                "type": "simple_response"
                            },
                            {
                                "speech": response,
                                "type": 0
                            }
                        ],
                        "parameters": [],
                        "resetContexts": false
                    }
                ],
                "templates": [question],
                "userSays": [],
                "webhookForSlotFilling": false,
                "webhookUsed": false
            };
            $.ajax({
                url: 'https://api.dialogflow.com/v1/intents?v=20150910',
                type: 'post',
                data: JSON.stringify(newData),
                headers: {
                    'Authorization': 'Bearer eafee8d8efc7491fb3d6dfecac94f687',
                    'Content-Type': 'application/json'
                },

                success: function (data) {
                    alert('Done');
                },
                error: function (data) {
                    alert("Failed, please try again.");
                }

            });
        });

    </script>

    <style>
        input[type=text],
        select {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        input[type=submit] {
            width: 100%;
            background-color: #4CAF50;
            color: white;
            padding: 14px 20px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        input[type=submit]:hover {
            background-color: #45a049;
        }

        div {
            border-radius: 5px;
            background-color: #f2f2f2;
            padding: 20px;
        }
    </style>

    <script src="/socket.io/socket.io.js"></script>
    <script src="js/script.js"></script>
    <style>
    </style>
</body>

</html>